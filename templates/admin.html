<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS - Titan Admin Panel</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body { font-family: 'Rajdhani', sans-serif; background-color: #020617; color: #e2e8f0; }
        .glass-card { background: rgba(15, 23, 42, 0.85); backdrop-filter: blur(16px); border: 1px solid rgba(56, 189, 248, 0.15); border-radius: 1rem; }
        .tab-btn { transition: all 0.3s ease; }
        .tab-btn.active { background-color: rgba(56, 189, 248, 0.15); color: #38bdf8; border-left: 4px solid #38bdf8; }
        .table-row-hover:hover { background-color: rgba(255, 255, 255, 0.03); }
        .data-font { font-family: 'JetBrains Mono', monospace; }
        
        #sidebar { transition: transform 0.3s ease-in-out; }
        #mobile-overlay { transition: opacity 0.3s ease-in-out; }
    </style>
</head>
<body class="flex flex-col md:flex-row h-screen overflow-hidden bg-[url('https://www.transparenttextures.com/patterns/stardust.png')] relative">

    <div class="md:hidden sticky top-0 flex justify-between items-center p-4 glass-card m-2 z-[60] shadow-lg shadow-sky-900/20 bg-[#0f172a]">
        <div class="flex items-center gap-2">
            <i class="fas fa-robot text-sky-400 text-2xl drop-shadow-[0_0_8px_rgba(56,189,248,0.8)]"></i>
            <h2 class="text-xl font-bold text-white tracking-wider">NEXUS GOD MODE</h2>
        </div>
        <button onclick="toggleMobileMenu()" class="text-sky-400 hover:text-white px-3 py-1 bg-slate-800/80 rounded border border-slate-700 transition-colors focus:outline-none">
            <i class="fas fa-bars text-2xl"></i>
        </button>
    </div>

    <div id="mobile-overlay" onclick="toggleMobileMenu()" class="fixed inset-0 bg-black/70 z-[65] hidden opacity-0 md:hidden"></div>

    <aside id="sidebar" class="fixed md:relative inset-y-0 left-0 w-64 glass-card m-2 md:m-4 flex flex-col justify-between transform -translate-x-full md:translate-x-0 z-[70] border-r border-slate-800 h-[calc(100vh-1rem)] md:h-[calc(100vh-2rem)]">
        <div>
            <div class="md:hidden absolute top-4 right-4">
                <button onclick="toggleMobileMenu()" class="text-slate-400 hover:text-red-400 focus:outline-none"><i class="fas fa-times text-2xl"></i></button>
            </div>
            
            <div class="p-6 text-center border-b border-slate-800/50 mt-8 md:mt-0">
                <h2 class="text-3xl font-bold text-sky-400 tracking-wider drop-shadow-md">NEXUS SMM</h2>
                <p class="text-xs text-rose-500 uppercase font-bold tracking-widest mt-1"><i class="fas fa-crown mr-1"></i> God Mode</p>
            </div>
            
            <nav class="p-4 space-y-2 overflow-y-auto max-h-[60vh]">
                <button onclick="switchTab('dashboard')" id="btn-dashboard" class="tab-btn active w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-slate-800/50 hover:text-white font-bold">
                    <i class="fas fa-chart-pie w-5 text-center"></i> Dashboard
                </button>
                <button onclick="switchTab('providers')" id="btn-providers" class="tab-btn w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-slate-800/50 hover:text-white font-bold">
                    <i class="fas fa-server w-5 text-center text-emerald-400"></i> Providers & Menus
                </button>
                <button onclick="switchTab('users')" id="btn-users" class="tab-btn w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-slate-800/50 hover:text-white font-bold">
                    <i class="fas fa-users-cog w-5 text-center"></i> Users Engine
                </button>
                <button onclick="switchTab('orders')" id="btn-orders" class="tab-btn w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-slate-800/50 hover:text-white font-bold">
                    <i class="fas fa-shopping-cart w-5 text-center"></i> Force Orders
                </button>
                <button onclick="switchTab('tickets')" id="btn-tickets" class="tab-btn w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-slate-800/50 hover:text-white font-bold">
                    <i class="fas fa-headset w-5 text-center"></i> Support Hub
                </button>
                <button onclick="switchTab('vouchers')" id="btn-vouchers" class="tab-btn w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-slate-800/50 hover:text-white font-bold">
                    <i class="fas fa-gift w-5 text-center"></i> Vouchers
                </button>
                <button onclick="switchTab('settings')" id="btn-settings" class="tab-btn w-full flex items-center gap-3 px-4 py-3 rounded-lg text-slate-400 hover:bg-slate-800/50 hover:text-white font-bold">
                    <i class="fas fa-sliders-h w-5 text-center"></i> Master Settings
                </button>
            </nav>
        </div>
        
        <div class="p-4 border-t border-slate-800/50">
            <a href="/logout" class="block w-full text-center bg-red-500/10 hover:bg-red-500/20 text-red-500 font-bold py-2 px-4 rounded-lg transition-colors border border-red-500/30">
                <i class="fas fa-power-off mr-2"></i> Lock System
            </a>
        </div>
    </aside>

    <main class="flex-1 p-2 md:p-8 overflow-y-auto relative z-10 h-full w-full scroll-smooth">
        
        <div id="tab-dashboard" class="tab-content block animate-[fadeIn_0.3s_ease-out]">
            <h2 class="text-2xl font-bold mb-6 text-white border-b border-slate-700 pb-2"><i class="fas fa-satellite-dish text-sky-400 mr-2"></i> Real-time Analytics</h2>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6 mb-8">
                <div class="glass-card p-6 border-l-4 border-rose-500 relative overflow-hidden bg-rose-500/5">
                    <div class="absolute top-2 right-2 flex space-x-1">
                        <span class="w-2 h-2 rounded-full bg-rose-500 animate-ping"></span>
                        <span class="w-2 h-2 rounded-full bg-rose-500"></span>
                    </div>
                    <i class="fas fa-eye absolute -right-4 -bottom-4 text-6xl text-rose-500/10"></i>
                    <h3 class="text-slate-400 text-sm font-bold uppercase tracking-wider mb-2">Live Users Online</h3>
                    <div class="text-4xl font-bold text-rose-400 data-font" id="live_users_count">74</div>
                </div>

                <div class="glass-card p-6 border-l-4 border-emerald-500 relative overflow-hidden">
                    <i class="fas fa-money-bill-wave absolute -right-4 -bottom-4 text-6xl text-emerald-500/10"></i>
                    <h3 class="text-slate-400 text-sm font-bold uppercase tracking-wider mb-2">Net Profit (Live)</h3>
                    <div class="text-4xl font-bold text-emerald-400 data-font">{{ profit }}</div>
                </div>
                
                <div class="glass-card p-6 border-l-4 border-sky-500 relative overflow-hidden">
                    <i class="fas fa-shopping-bag absolute -right-4 -bottom-4 text-6xl text-sky-500/10"></i>
                    <h3 class="text-slate-400 text-sm font-bold uppercase tracking-wider mb-2">Total Gross Sales</h3>
                    <div class="text-4xl font-bold text-sky-400 data-font">{{ sales }}</div>
                </div>
                
                <div class="glass-card p-6 border-l-4 border-purple-500 relative overflow-hidden">
                    <i class="fas fa-wallet absolute -right-4 -bottom-4 text-6xl text-purple-500/10"></i>
                    <h3 class="text-slate-400 text-sm font-bold uppercase tracking-wider mb-2">User Balances</h3>
                    <div class="text-4xl font-bold text-purple-400 data-font">{{ bal }}</div>
                </div>
                
                <div class="glass-card p-6 border-l-4 border-amber-500 relative overflow-hidden">
                    <i class="fas fa-users absolute -right-4 -bottom-4 text-6xl text-amber-500/10"></i>
                    <h3 class="text-slate-400 text-sm font-bold uppercase tracking-wider mb-2">Total Users</h3>
                    <div class="text-3xl font-bold text-amber-400 data-font">{{ u_count }}</div>
                </div>
                
                <div class="glass-card p-6 border-l-4 border-indigo-500 relative overflow-hidden">
                    <i class="fas fa-heartbeat absolute -right-4 -bottom-4 text-6xl text-indigo-500/10"></i>
                    <h3 class="text-slate-400 text-sm font-bold uppercase tracking-wider mb-2">Engine Status</h3>
                    <div class="text-2xl font-bold mt-1">
                        {% if s.maintenance %}
                            <span class="text-red-500"><i class="fas fa-tools animate-pulse"></i> Maintenance</span>
                        {% else %}
                            <span class="text-green-500"><i class="fas fa-check-circle"></i> Fully Active</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6 mb-8">
                <div class="glass-card p-4 md:p-6 border border-slate-700/50 border-t-4 border-t-sky-500">
                    <h3 class="text-lg font-bold text-sky-400 mb-2"><i class="fas fa-globe mr-2"></i> Global Broadcast</h3>
                    <form action="/send_broadcast" method="POST" class="flex flex-col gap-3">
                        <textarea name="msg" placeholder="Write global message here..." rows="2" class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white outline-none focus:border-sky-500" required></textarea>
                        <button type="submit" class="bg-sky-500 hover:bg-sky-400 text-slate-900 font-bold px-6 py-2 rounded-lg w-full md:w-auto transition-colors">Send to All</button>
                    </form>
                </div>
                
                <div class="glass-card p-4 md:p-6 border border-slate-700/50 border-t-4 border-t-emerald-500">
                    <h3 class="text-lg font-bold text-emerald-400 mb-2"><i class="fas fa-bullseye mr-2"></i> Smart Cast (Active Buyers)</h3>
                    <form action="/smart_cast" method="POST" class="flex flex-col gap-3">
                        <textarea name="msg" placeholder="Write exclusive offer here..." rows="2" class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white outline-none focus:border-emerald-500" required></textarea>
                        <button type="submit" class="bg-emerald-500 hover:bg-emerald-400 text-slate-900 font-bold px-6 py-2 rounded-lg w-full md:w-auto transition-colors">Send Offer</button>
                    </form>
                </div>
            </div>
        </div>

        <div id="tab-providers" class="tab-content hidden animate-[fadeIn_0.3s_ease-out]">
            <h2 class="text-2xl font-bold mb-6 text-emerald-400 border-b border-slate-700 pb-2"><i class="fas fa-network-wired mr-2"></i> Providers & Dynamic Menus</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                <div class="glass-card p-6 lg:col-span-1 border-t-4 border-t-emerald-500 h-fit">
                    <h3 class="text-lg font-bold text-white mb-4">Connect New Panel API</h3>
                    <form action="/add_provider" method="POST" class="space-y-4">
                        <div>
                            <label class="block text-slate-400 text-xs font-bold mb-1 uppercase">Panel Name</label>
                            <input type="text" name="provider_name" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none focus:border-emerald-500 text-sm" required placeholder="e.g. JustAnotherPanel">
                        </div>
                        <div>
                            <label class="block text-slate-400 text-xs font-bold mb-1 uppercase">API URL</label>
                            <input type="url" name="api_url" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none focus:border-emerald-500 text-sm data-font" required placeholder="https://panel.com/api/v2">
                        </div>
                        <div>
                            <label class="block text-slate-400 text-xs font-bold mb-1 uppercase">API Key</label>
                            <input type="password" name="api_key" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none focus:border-emerald-500 text-sm" required placeholder="Secret API Key">
                        </div>
                        <div>
                            <label class="block text-slate-400 text-xs font-bold mb-1 uppercase">Extra Margin % (Optional)</label>
                            <input type="number" step="0.01" name="provider_margin" value="0" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none focus:border-emerald-500 text-sm">
                            <p class="text-[10px] text-slate-500 mt-1">Leave 0 to use the global profit margin.</p>
                        </div>
                        <button type="submit" class="w-full bg-emerald-500 hover:bg-emerald-600 text-slate-900 font-bold py-2 rounded transition shadow-[0_0_10px_rgba(16,185,129,0.3)]">Add Provider</button>
                    </form>
                </div>

                <div class="glass-card p-4 lg:col-span-2 overflow-hidden">
                    <h3 class="text-lg font-bold text-white mb-4 border-b border-slate-700/50 pb-2">Active Providers</h3>
                    <div class="overflow-x-auto max-h-[350px]">
                        <table class="w-full text-left border-collapse whitespace-nowrap">
                            <thead class="bg-slate-900/80 text-slate-400 text-xs uppercase tracking-wider sticky top-0 z-10">
                                <tr>
                                    <th class="p-3">Panel Info</th>
                                    <th class="p-3">API URL</th>
                                    <th class="p-3 text-center">Status</th>
                                    <th class="p-3 text-right">Actions</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-800/50 text-sm">
                                <tr class="hover:bg-slate-800/30 transition-colors bg-sky-900/10">
                                    <td class="p-3">
                                        <div class="font-bold text-sky-400">Main Panel <i class="fas fa-star text-yellow-400 text-[10px]" title="From config.py"></i></div>
                                        <div class="text-[10px] text-slate-500 data-font">Margin: Global</div>
                                    </td>
                                    <td class="p-3 text-slate-400 max-w-[200px] truncate data-font text-xs">Linked via config.py</td>
                                    <td class="p-3 text-center"><span class="bg-sky-500/10 text-sky-400 px-2 py-1 rounded text-[10px] font-bold uppercase border border-sky-500/30">System</span></td>
                                    <td class="p-3 text-right text-xs text-slate-600">Fixed</td>
                                </tr>
                                {% for p in providers %}
                                <tr class="hover:bg-slate-800/30 transition-colors">
                                    <td class="p-3">
                                        <div class="font-bold text-white">{{ p.name }}</div>
                                        <div class="text-[10px] text-slate-500 data-font">ID: {{ p._id }}<br>Margin: {% if p.profit_margin > 0 %}+{{ p.profit_margin }}%{% else %}Global{% endif %}</div>
                                    </td>
                                    <td class="p-3 text-slate-300 max-w-[200px] truncate data-font text-xs" title="{{ p.api_url }}">{{ p.api_url }}</td>
                                    <td class="p-3 text-center">
                                        {% if p.status == 'active' %}
                                        <span class="bg-emerald-500/10 text-emerald-400 border border-emerald-500/30 px-2 py-1 rounded text-[10px] font-bold uppercase">Active</span>
                                        {% else %}
                                        <span class="bg-red-500/10 text-red-400 border border-red-500/30 px-2 py-1 rounded text-[10px] font-bold uppercase">Paused</span>
                                        {% endif %}
                                    </td>
                                    <td class="p-3 text-right">
                                        <a href="/toggle_provider/{{ p._id }}" class="bg-slate-700 hover:bg-slate-600 text-white p-2 rounded transition inline-block mx-1" title="Pause/Play"><i class="fas fa-power-off text-xs"></i></a>
                                        <a href="/delete_provider/{{ p._id }}" class="bg-red-500/20 hover:bg-red-500 text-red-400 hover:text-white p-2 rounded transition inline-block" onclick="return confirm('Warning: Deleting this panel will break orders linked to it! Proceed?')"><i class="fas fa-trash text-xs"></i></a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <h3 class="text-xl font-bold mb-4 text-sky-400 border-b border-slate-700 pb-2 mt-8"><i class="fas fa-layer-group mr-2"></i> Custom Menu & Service Mapping</h3>
            
            <div class="glass-card p-4 md:p-6 mb-6 border-t-4 border-t-sky-500">
                <form action="/create_category" method="POST" class="flex flex-col md:flex-row gap-4 items-end">
                    <div class="flex-1 w-full">
                        <label class="block text-slate-400 text-xs font-bold mb-1 uppercase">Button Name (e.g. üöÄ VIP Instagram)</label>
                        <input type="text" name="cat_name" required class="w-full bg-slate-900 border border-slate-700 rounded px-4 py-2 text-white outline-none focus:border-sky-500">
                    </div>
                    <div class="w-full md:w-1/3">
                        <label class="block text-slate-400 text-xs font-bold mb-1 uppercase">Main Platform Type</label>
                        <select name="platform" class="w-full bg-slate-900 border border-slate-700 rounded px-4 py-2 text-white outline-none focus:border-sky-500">
                            <option value="Instagram">üì∏ Instagram</option>
                            <option value="Facebook">üìò Facebook</option>
                            <option value="YouTube">‚ñ∂Ô∏è YouTube</option>
                            <option value="Telegram">‚úàÔ∏è Telegram</option>
                            <option value="TikTok">üéµ TikTok</option>
                            <option value="Twitter">üê¶ Twitter</option>
                            <option value="Other">üåê Other</option>
                        </select>
                    </div>
                    <button type="submit" class="bg-sky-500 hover:bg-sky-400 text-slate-900 font-bold px-6 py-2 rounded h-[42px] transition w-full md:w-auto"><i class="fas fa-plus mr-1"></i> Create Menu Button</button>
                </form>
            </div>

            <div class="grid grid-cols-1 xl:grid-cols-2 gap-6">
                {% for menu in custom_menus %}
                <div class="glass-card p-4 relative border border-slate-700/50 hover:border-sky-500/30 transition-colors">
                    <div class="flex justify-between items-center mb-4 border-b border-slate-700/50 pb-2">
                        <div>
                            <h4 class="text-lg font-bold text-white">{{ menu.name }}</h4>
                            <span class="text-[10px] text-sky-400 uppercase tracking-widest bg-sky-500/10 px-2 py-0.5 rounded">{{ menu.platform }}</span>
                        </div>
                        <a href="/delete_category/{{ menu.id }}" class="text-red-500/50 hover:text-red-500 p-2 transition-colors" onclick="return confirm('Delete this custom button entirely?')"><i class="fas fa-trash"></i></a>
                    </div>
                    
                    <form action="/add_service_map" method="POST" class="bg-slate-900/50 p-3 rounded-lg border border-slate-700/50 mb-4 flex flex-col gap-2">
                        <input type="hidden" name="cat_id" value="{{ menu.id }}">
                        <div class="grid grid-cols-2 gap-2">
                            <select name="provider_id" required class="bg-slate-900 border border-slate-700 rounded px-2 py-1.5 text-xs text-white outline-none focus:border-sky-500">
                                <option value="">Select Panel...</option>
                                <option value="MAIN" class="text-sky-400 font-bold">Main Panel (config.py)</option>
                                {% for p in providers %}
                                <option value="{{ p._id }}">{{ p.name }}</option>
                                {% endfor %}
                            </select>
                            <input type="text" name="service_id" placeholder="Service ID in Panel" required class="bg-slate-900 border border-slate-700 rounded px-2 py-1.5 text-xs text-white outline-none focus:border-sky-500 data-font">
                        </div>
                        <div class="flex gap-2">
                            <input type="text" name="custom_name" placeholder="Custom Display Name" required class="flex-1 bg-slate-900 border border-slate-700 rounded px-2 py-1.5 text-xs text-white outline-none focus:border-sky-500">
                            <input type="number" step="0.001" name="custom_rate" placeholder="Custom Cost ($) [Opt]" class="w-1/3 bg-slate-900 border border-slate-700 rounded px-2 py-1.5 text-xs text-white outline-none focus:border-sky-500 data-font">
                            <button type="submit" class="bg-emerald-500 hover:bg-emerald-400 text-slate-900 px-3 py-1.5 rounded text-xs font-bold transition-colors"><i class="fas fa-save"></i></button>
                        </div>
                    </form>

                    <div class="overflow-y-auto max-h-[200px] pr-1 space-y-2">
                        {% for srv in menu.services %}
                        <div class="bg-slate-800/40 p-2 rounded border border-slate-700 flex justify-between items-center text-sm group">
                            <div class="truncate pr-2 flex-1">
                                <span class="text-sky-400 font-bold data-font text-[10px] bg-slate-900 px-1 rounded border border-slate-600">ID:{{ srv.service_id }}</span>
                                <span class="text-white ml-1 text-xs">{{ srv.custom_name }}</span>
                                <div class="text-[9px] text-slate-500 mt-0.5">Provider: {% if srv.provider_id == 'MAIN' %}Main Panel{% else %}{{ srv.provider_id }}{% endif %}</div>
                            </div>
                            <div class="flex items-center gap-2">
                                {% if srv.custom_rate %}<span class="text-emerald-400 data-font text-[10px] bg-emerald-500/10 px-1 rounded border border-emerald-500/20">${{ srv.custom_rate }}</span>{% endif %}
                                <a href="/delete_service_map/{{ menu.id }}/{{ srv.provider_id }}/{{ srv.service_id }}" class="text-slate-500 hover:text-red-400 text-xs p-1"><i class="fas fa-times"></i></a>
                            </div>
                        </div>
                        {% else %}
                        <div class="text-center text-slate-500 text-xs py-4 border border-dashed border-slate-700 rounded">No services mapped to this button yet.</div>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <div id="tab-users" class="tab-content hidden animate-[fadeIn_0.3s_ease-out]">
            <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-6 border-b border-slate-700 pb-4 gap-4">
                <h2 class="text-2xl font-bold text-white"><i class="fas fa-users-cog text-sky-400 mr-2"></i> Users Engine</h2>
                
                <div class="flex flex-wrap gap-2 w-full lg:w-auto">
                    <a href="/distribute_rewards" class="flex-1 md:flex-none text-center bg-amber-500/10 border border-amber-500/50 hover:bg-amber-500 hover:text-slate-900 text-amber-400 text-sm font-bold px-4 py-2 rounded transition-all shadow-[0_0_10px_rgba(245,158,11,0.2)]" onclick="return confirm('Send wallet cash to Top 3 Spenders and Affiliates?');">
                        <i class="fas fa-gift mr-1"></i> Pay Rewards
                    </a>
                    <a href="/reset_monthly" class="flex-1 md:flex-none text-center bg-rose-500/10 border border-rose-500/50 hover:bg-rose-500 hover:text-white text-rose-400 text-sm font-bold px-4 py-2 rounded transition-all" onclick="return confirm('Are you sure you want to reset all spents and referral earnings to 0 for the new month?');">
                        <i class="fas fa-recycle mr-1"></i> Reset Board
                    </a>
                    <button onclick="generateRivals()" id="btn_rivals" class="flex-1 md:flex-none text-center bg-purple-500/10 border border-purple-500/50 hover:bg-purple-500 hover:text-white text-purple-400 text-sm font-bold px-4 py-2 rounded transition-all">
                        <i class="fas fa-robot mr-1"></i> Add Fake User
                    </button>
                    <a href="/remove_fake_users" class="flex-1 md:flex-none text-center bg-red-500/10 border border-red-500/50 hover:bg-red-500 hover:text-white text-red-400 text-sm font-bold px-4 py-2 rounded transition-all" onclick="return confirm('Are you sure you want to completely wipe all fake users?');">
                        <i class="fas fa-trash-alt mr-1"></i> Clear Fakes
                    </a>
                    <a href="/export_csv" class="flex-1 md:flex-none text-center bg-indigo-500/10 border border-indigo-500/50 hover:bg-indigo-500 hover:text-white text-indigo-400 text-sm font-bold px-4 py-2 rounded transition-colors">
                        <i class="fas fa-file-csv mr-1"></i> CSV
                    </a>
                    <a href="/smart_cleanup" class="flex-1 md:flex-none text-center bg-cyan-500/10 border border-cyan-500/50 hover:bg-cyan-500 hover:text-slate-900 text-cyan-400 text-sm font-bold px-4 py-2 rounded transition-all shadow-[0_0_10px_rgba(6,182,212,0.2)]" onclick="return confirm('Are you sure you want to run Smart Cleanup?');">
                        <i class="fas fa-broom mr-1"></i> Smart Clean
                    </a>
                </div>
            </div>

            <div class="glass-card p-4 mb-6 border-l-4 border-slate-500">
                <form action="/add_fake_user" method="POST" class="flex flex-col sm:flex-row items-center gap-3">
                    <span class="text-sm font-bold text-slate-400 w-full sm:w-auto"><i class="fas fa-plus-circle"></i> Custom Fake:</span>
                    <input type="text" name="fake_name" placeholder="Name" required class="w-full sm:w-auto bg-slate-900 border border-slate-700 rounded px-3 py-2 sm:py-1 text-sm text-white outline-none focus:border-sky-500">
                    <input type="number" step="0.01" name="fake_spent" placeholder="Spent ($)" required class="w-full sm:w-24 bg-slate-900 border border-slate-700 rounded px-3 py-2 sm:py-1 text-sm text-white outline-none focus:border-sky-500">
                    <input type="number" step="0.01" name="fake_ref" placeholder="Ref Earn ($)" required class="w-full sm:w-24 bg-slate-900 border border-slate-700 rounded px-3 py-2 sm:py-1 text-sm text-white outline-none focus:border-sky-500">
                    <button type="submit" class="w-full sm:w-auto bg-slate-700 hover:bg-slate-600 text-white text-sm font-bold px-4 py-2 sm:py-1.5 rounded transition-colors">Add</button>
                </form>
            </div>

            <div class="mb-4">
                <input type="text" id="userSearch" onkeyup="filterTable('userTable', 'userSearch')" placeholder="Search by ID or Name..." class="w-full bg-slate-900 border border-slate-700 rounded px-4 py-2 text-white outline-none focus:border-sky-500 shadow-inner">
            </div>

            <div class="glass-card overflow-hidden">
                <div class="overflow-x-auto max-h-[60vh]">
                    <table class="w-full text-left border-collapse whitespace-nowrap" id="userTable">
                        <thead>
                            <tr class="bg-slate-800/80 text-sky-400 text-sm uppercase tracking-wider">
                                <th class="p-4 border-b border-slate-700 font-semibold">User Info</th>
                                <th class="p-4 border-b border-slate-700 font-semibold">Financials</th>
                                <th class="p-4 border-b border-slate-700 font-semibold text-center">Status</th>
                                <th class="p-4 border-b border-slate-700 font-semibold text-right">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="text-sm divide-y divide-slate-800/50">
                            {% for u in users %}
                            <tr class="table-row-hover transition-colors group">
                                <td class="p-4">
                                    <div class="font-bold text-white flex items-center gap-2">
                                        {{ u.get('name', 'N/A') }}
                                        {% if u.get('tier_override') %}<span class="text-[9px] bg-amber-500/20 text-amber-400 px-1.5 py-0.5 rounded border border-amber-500/30 uppercase"><i class="fas fa-crown"></i> {{ u.get('tier_override') }}</span>{% endif %}
                                    </div>
                                    <div class="text-xs text-slate-500 data-font mt-1">UID: {{ u['_id'] }}</div>
                                </td>
                                <td class="p-4">
                                    <div class="text-emerald-400 font-bold data-font">Bal: ${{ "%.3f"|format(u.get('balance', 0)) }}</div>
                                    <div class="text-sky-400 text-[11px] data-font mt-1">Spn: ${{ "%.3f"|format(u.get('spent', 0)) }} | Ref: ${{ "%.3f"|format(u.get('ref_earnings', 0)) }} | <span class="text-amber-400">Pts: {{ u.get('points', 0) }}</span></div>
                                </td>
                                <td class="p-4 text-center">
                                    {% if u.get('is_fake') %}
                                        <span class="text-purple-400 text-[10px] font-bold border border-purple-500/30 px-2 py-1 rounded bg-purple-500/10 uppercase">Fake Bot</span>
                                    {% else %}
                                        {% if u.get('shadow_banned') %}
                                            <span class="text-rose-500 text-[10px] font-bold border border-rose-500/30 px-2 py-1 rounded bg-rose-500/10 uppercase animate-pulse"><i class="fas fa-ghost"></i> Shadowed</span>
                                        {% elif u.get('banned') %}
                                            <span class="text-red-500 text-[10px] font-bold border border-red-500/30 px-2 py-1 rounded bg-red-500/10 uppercase"><i class="fas fa-ban"></i> Banned</span>
                                        {% else %}
                                            <span class="text-emerald-400 text-[10px] font-bold border border-emerald-500/30 px-2 py-1 rounded bg-emerald-500/10 uppercase">Active</span>
                                        {% endif %}
                                    {% endif %}
                                </td>
                                <td class="p-4 text-right">
                                    <div class="flex items-center justify-end space-x-2 opacity-80 group-hover:opacity-100 transition-opacity">
                                        {% if not u.get('is_fake') %}
                                            <button onclick="openUserModal('{{ u['_id'] }}', '{{ u.get('balance', 0) }}', '{{ u.get('spent', 0) }}', '{{ u.get('ref_earnings', 0) }}', '{{ u.get('custom_discount', 0) }}', '{{ u.get('tier_override', 'none') }}', '{{ u.get('points', 0) }}')" class="bg-sky-500/10 text-sky-400 border border-sky-500/30 hover:bg-sky-500 hover:text-white px-2 py-1 rounded transition-all" title="Edit Data"><i class="fas fa-pencil-alt"></i></button>
                                            
                                            <a href="/toggle_shadow_ban/{{ u['_id'] }}" class="bg-slate-700 hover:bg-rose-500 {% if u.get('shadow_banned') %}text-rose-400{% else %}text-slate-300{% endif %} px-2 py-1 rounded transition-all" title="Shadow Ban"><i class="fas fa-ghost"></i></a>
                                            
                                            {% if u.get('banned') %}
                                                <a href="/unban_user/{{ u['_id'] }}" class="bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 hover:bg-emerald-500 hover:text-white px-2 py-1 rounded transition-all" title="Unban"><i class="fas fa-check-circle"></i></a>
                                            {% else %}
                                                <a href="/ban_user/{{ u['_id'] }}" class="bg-red-500/20 text-red-400 border border-red-500/30 hover:bg-red-500 hover:text-white px-2 py-1 rounded transition-all" title="Hard Ban"><i class="fas fa-ban"></i></a>
                                            {% endif %}
                                        {% endif %}
                                        <a href="/delete_user/{{ u['_id'] }}" onclick="return confirm('Are you sure you want to permanently delete this user?');" class="text-red-500/70 hover:text-red-500 ml-2" title="Delete User"><i class="fas fa-trash-alt"></i></a>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="userEditModal" class="fixed inset-0 bg-black/80 z-[100] hidden flex items-center justify-center p-4 opacity-0 transition-opacity duration-300">
            <div class="glass-card w-full max-w-md p-6 relative border-t-4 border-sky-500 transform scale-95 transition-transform duration-300" id="userEditBox">
                <button onclick="closeUserModal()" class="absolute top-4 right-4 text-slate-400 hover:text-red-500 focus:outline-none"><i class="fas fa-times text-xl"></i></button>
                <h3 class="text-xl font-bold text-white mb-4"><i class="fas fa-user-edit text-sky-400 mr-2"></i> Edit User <span id="modal_uid_display" class="text-sky-500 data-font text-sm ml-2"></span></h3>
                
                <form action="/edit_user" method="POST" class="space-y-4">
                    <input type="hidden" name="user_id" id="modal_uid">
                    
                    <div>
                        <label class="block text-xs text-sky-400 font-bold uppercase mb-1">Balance ($)</label>
                        <div class="flex gap-2">
                            <select name="bal_action" class="bg-slate-900 border border-slate-700 rounded px-2 py-2 text-white outline-none w-1/3 text-sm focus:border-sky-500">
                                <option value="set">Set To</option>
                                <option value="add">+ Add</option>
                                <option value="sub">- Sub</option>
                            </select>
                            <input type="number" step="0.001" name="balance_val" id="modal_balance_val" class="w-2/3 bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none focus:border-sky-500 data-font" required>
                        </div>
                    </div>

                    <div class="grid grid-cols-3 gap-2">
                        <div>
                            <label class="block text-[10px] text-slate-400 font-bold uppercase mb-1">Total Spent</label>
                            <input type="number" step="0.001" name="spent" id="modal_spent" class="w-full bg-slate-900 border border-slate-700 rounded px-2 py-2 text-white outline-none focus:border-sky-500 data-font text-sm" required>
                        </div>
                        <div>
                            <label class="block text-[10px] text-emerald-400 font-bold uppercase mb-1">Ref Earned</label>
                            <input type="number" step="0.001" name="ref_earnings" id="modal_ref" class="w-full bg-slate-900 border border-emerald-500/50 rounded px-2 py-2 text-white outline-none focus:border-emerald-500 data-font text-sm" required>
                        </div>
                        <div>
                            <label class="block text-[10px] text-amber-400 font-bold uppercase mb-1">Points</label>
                            <input type="number" name="points" id="modal_points" class="w-full bg-slate-900 border border-amber-500/50 rounded px-2 py-2 text-white outline-none focus:border-amber-500 data-font text-sm" required>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs text-rose-400 font-bold uppercase mb-1"><i class="fas fa-percent"></i> Custom Off (%)</label>
                            <input type="number" step="0.1" name="custom_discount" id="modal_discount" class="w-full bg-slate-900 border border-rose-500/50 rounded px-3 py-2 text-white outline-none focus:border-rose-500 data-font">
                        </div>
                        <div>
                            <label class="block text-xs text-purple-400 font-bold uppercase mb-1"><i class="fas fa-crown"></i> VIP Tier</label>
                            <select name="tier_override" id="modal_tier" class="w-full bg-slate-900 border border-purple-500/50 rounded px-3 py-2 text-white outline-none focus:border-purple-500 text-sm">
                                <option value="none">Auto (By Spent)</option>
                                <option value="üíé Diamond VIP">üíé Diamond VIP</option>
                                <option value="ü•á Gold VIP">ü•á Gold VIP</option>
                                <option value="ü•à Silver VIP">ü•à Silver VIP</option>
                            </select>
                        </div>
                    </div>
                    
                    <button type="submit" class="w-full bg-sky-500 hover:bg-sky-400 text-slate-900 font-bold py-2.5 rounded-lg mt-2 transition-colors shadow-[0_0_10px_rgba(56,189,248,0.3)]">Save Modifications</button>
                </form>
            </div>
        </div>

        <div id="tab-orders" class="tab-content hidden animate-[fadeIn_0.3s_ease-out]">
            <h2 class="text-2xl font-bold mb-6 text-white border-b border-slate-700 pb-2"><i class="fas fa-dolly text-sky-400 mr-2"></i> Force Orders Engine</h2>
            
            <div class="mb-4">
                <input type="text" id="orderSearch" onkeyup="filterTable('orderTable', 'orderSearch')" placeholder="Search Order ID, UID or Link..." class="w-full bg-slate-900 border border-slate-700 rounded px-4 py-2 text-white outline-none focus:border-sky-500 shadow-inner">
            </div>

            <div class="glass-card overflow-hidden">
                <div class="overflow-x-auto max-h-[75vh]">
                    <table class="w-full text-left border-collapse whitespace-nowrap" id="orderTable">
                        <thead>
                            <tr class="bg-slate-800/80 text-sky-400 text-sm uppercase tracking-wider">
                                <th class="p-4 border-b border-slate-700 font-semibold">System ID</th>
                                <th class="p-4 border-b border-slate-700 font-semibold">User</th>
                                <th class="p-4 border-b border-slate-700 font-semibold">Order Data</th>
                                <th class="p-4 border-b border-slate-700 font-semibold">Status</th>
                                <th class="p-4 border-b border-slate-700 font-semibold text-right">Force Action</th>
                            </tr>
                        </thead>
                        <tbody class="text-sm divide-y divide-slate-800/50">
                            {% for o in orders %}
                            <tr class="table-row-hover transition-colors">
                                <td class="p-4 data-font text-white font-bold">#{{ o['oid'] }}</td>
                                <td class="p-4 data-font text-slate-400">UID: {{ o['uid'] }}</td>
                                <td class="p-4">
                                    <div class="text-xs text-sky-400 font-bold mb-1">
                                        SID: {{ o.get('sid', 'N/A') }} | QTY: {{ o.get('qty', 0) }}
                                        {% if o.get('provider_id') and o.get('provider_id') != 'MAIN' %}<i class="fas fa-server text-emerald-400 ml-1" title="Custom Panel"></i>{% endif %}
                                    </div>
                                    <div class="text-[10px] text-emerald-400 data-font mb-1">Cost: ${{ "%.3f"|format(o.get('cost', 0)) }}</div>
                                    <div class="text-[10px] text-slate-500 truncate max-w-[150px]" title="{{ o.get('link', o.get('username', 'N/A')) }}">{{ o.get('link', o.get('username', 'N/A')) }}</div>
                                </td>
                                <td class="p-4">
                                    {% set st = o.get('status', '')|lower %}
                                    {% if o.get('is_shadow') %}
                                        <span class="text-rose-500 bg-rose-500/10 border border-rose-500/30 font-bold px-2 py-1 rounded text-[10px] uppercase"><i class="fas fa-ghost"></i> Ghosted</span>
                                    {% elif st == 'completed' %}
                                        <span class="text-emerald-400 bg-emerald-400/10 border border-emerald-500/30 font-bold px-2 py-1 rounded text-[10px] uppercase"><i class="fas fa-check"></i> Done</span>
                                    {% elif st in ['canceled','refunded', 'error', 'fail'] %}
                                        <span class="text-red-400 bg-red-400/10 border border-red-500/30 font-bold px-2 py-1 rounded text-[10px] uppercase"><i class="fas fa-times"></i> {{ st }}</span>
                                    {% else %}
                                        <span class="text-amber-400 bg-amber-400/10 border border-amber-500/30 font-bold px-2 py-1 rounded text-[10px] uppercase"><i class="fas fa-spinner fa-spin"></i> Wait</span>
                                    {% endif %}
                                </td>
                                <td class="p-4 text-right space-x-1">
                                    {% if st in ['pending', 'processing', 'in progress'] %}
                                        <a href="/override_order/{{ o['oid'] }}/completed" class="inline-block text-[10px] uppercase bg-emerald-500/10 text-emerald-400 border border-emerald-500/30 hover:bg-emerald-500 hover:text-white px-2 py-1 rounded font-bold transition-colors" title="Force Complete"><i class="fas fa-check-double"></i> Complete</a>
                                        <a href="/override_order/{{ o['oid'] }}/canceled" class="inline-block text-[10px] uppercase bg-red-500/10 text-red-400 border border-red-500/30 hover:bg-red-500 hover:text-white px-2 py-1 rounded font-bold transition-colors" title="Force Cancel"><i class="fas fa-ban"></i> Cancel</a>
                                    {% endif %}
                                    
                                    {% if st not in ['refunded', 'canceled', 'error', 'fail'] and not o.get('is_shadow') %}
                                        <a href="/refund_order/{{ o['oid'] }}" class="inline-block text-[10px] uppercase bg-amber-500/10 text-amber-400 border border-amber-500/30 hover:bg-amber-500 hover:text-slate-900 px-2 py-1 rounded font-bold transition-colors" onclick="return confirm('Refund this order to the user?');">Refund</a>
                                    {% endif %}
                                    <a href="/delete_order/{{ o['oid'] }}" class="inline-block text-xs text-slate-500 hover:text-red-500 px-2 py-1 transition-colors" onclick="return confirm('Permanently delete this order record?');"><i class="fas fa-trash"></i></a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="tab-tickets" class="tab-content hidden animate-[fadeIn_0.3s_ease-out]">
            <h2 class="text-2xl font-bold mb-6 text-white border-b border-slate-700 pb-2"><i class="fas fa-headset text-sky-400 mr-2"></i> Support Hub</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6">
                {% for t in tickets %}
                <div class="glass-card p-4 relative border-l-4 {% if t.status == 'open' %}border-amber-500{% else %}border-emerald-500 opacity-70{% endif %}">
                    <div class="flex justify-between items-start mb-3">
                        <span class="text-xs text-slate-500 data-font">UID: {{ t.uid }}</span>
                        <a href="/delete_ticket/{{ t['_id'] }}" class="text-slate-500 hover:text-red-500"><i class="fas fa-trash"></i></a>
                    </div>
                    <div class="text-white text-sm mb-4 bg-slate-900/50 p-3 rounded border border-slate-700/50 break-words"><i class="fas fa-comment-dots text-sky-500/50 mr-2"></i> {{ t.msg }}</div>
                    {% if t.status == 'open' %}
                    <form action="/reply_ticket" method="POST" class="flex flex-col sm:flex-row gap-2">
                        <input type="hidden" name="ticket_id" value="{{ t['_id'] }}">
                        <input type="hidden" name="uid" value="{{ t.uid }}">
                        <input type="text" name="reply_msg" placeholder="Write reply..." required class="flex-1 bg-slate-900 border border-slate-700 rounded px-3 py-2 text-sm text-white focus:border-sky-500 outline-none">
                        <button type="submit" class="bg-sky-500 hover:bg-sky-400 text-slate-900 font-bold px-4 py-2 rounded text-sm transition-colors"><i class="fas fa-paper-plane mr-1"></i> Send</button>
                    </form>
                    {% else %}
                    <div class="bg-emerald-500/10 border border-emerald-500/20 p-3 rounded text-sm text-emerald-400"><i class="fas fa-reply mr-2"></i> {{ t.get('reply', '') }}</div>
                    {% endif %}
                </div>
                {% endfor %}
                {% if not tickets %} <div class="col-span-full text-center text-slate-500 py-10 glass-card border border-dashed border-slate-700">All tickets solved!</div> {% endif %}
            </div>
        </div>

        <div id="tab-vouchers" class="tab-content hidden animate-[fadeIn_0.3s_ease-out]">
            <h2 class="text-2xl font-bold mb-6 text-white border-b border-slate-700 pb-2"><i class="fas fa-ticket-alt text-sky-400 mr-2"></i> Gift Vouchers</h2>
            <div class="glass-card p-6 border-t-4 border-sky-500 mb-6">
                <form action="/create_voucher" method="POST" class="flex flex-col md:flex-row gap-4 items-end">
                    <div class="flex-1 w-full">
                        <label class="block text-slate-400 text-xs font-bold mb-1 uppercase">Voucher Code</label>
                        <input type="text" name="code" placeholder="e.g. FREEVIP" required class="w-full bg-slate-900 border border-slate-700 rounded px-4 py-2 text-white uppercase font-bold tracking-widest outline-none focus:border-sky-500">
                    </div>
                    <div class="w-full md:w-32">
                        <label class="block text-slate-400 text-xs font-bold mb-1 uppercase">Reward ($)</label>
                        <input type="number" step="0.01" name="amount" placeholder="0.00" required class="w-full bg-slate-900 border border-slate-700 rounded px-4 py-2 text-white outline-none focus:border-sky-500 data-font">
                    </div>
                    <div class="w-full md:w-32">
                        <label class="block text-slate-400 text-xs font-bold mb-1 uppercase">Usage Limit</label>
                        <input type="number" name="limit" placeholder="10" required class="w-full bg-slate-900 border border-slate-700 rounded px-4 py-2 text-white outline-none focus:border-sky-500 data-font">
                    </div>
                    <button type="submit" class="bg-sky-500 hover:bg-sky-400 text-slate-900 font-bold px-6 py-2 rounded h-[42px] w-full md:w-auto transition-colors"><i class="fas fa-plus mr-1"></i> Create</button>
                </form>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                {% for v in vouchers %}
                <div class="glass-card p-4 relative overflow-hidden group border-l-4 {% if v.used_by|length >= v.limit %}border-red-500 opacity-60{% else %}border-emerald-500{% endif %}">
                    <div class="absolute -right-6 -top-6 bg-emerald-500/20 w-16 h-16 rounded-full blur-xl group-hover:bg-emerald-500/40 transition-colors"></div>
                    <div class="flex justify-between items-start mb-2">
                        <div class="text-xl font-bold text-white tracking-widest data-font">{{ v.code }}</div>
                        <div class="text-emerald-400 font-bold bg-emerald-500/10 px-2 py-0.5 rounded border border-emerald-500/20 data-font">${{ v.amount }}</div>
                    </div>
                    
                    <div class="w-full bg-slate-900 rounded-full h-2 mb-2 border border-slate-700 overflow-hidden">
                        <div class="bg-sky-500 h-full rounded-full" style="width: {{ (v.used_by|length / v.limit) * 100 }}%"></div>
                    </div>
                    <div class="flex justify-between text-[10px] font-bold text-slate-400 uppercase">
                        <span>Used: {{ v.used_by|length }}</span>
                        <span>Limit: {{ v.limit }}</span>
                    </div>
                </div>
                {% else %}
                <div class="col-span-full text-center text-slate-500 py-10 glass-card border border-dashed border-slate-700">No active vouchers found.</div>
                {% endfor %}
            </div>
        </div>

        <div id="tab-settings" class="tab-content hidden animate-[fadeIn_0.3s_ease-out] pb-12">
            <h2 class="text-2xl font-bold mb-6 text-white border-b border-slate-700 pb-2"><i class="fas fa-cogs text-sky-400 mr-2"></i> Master Settings</h2>
            
            <form action="/settings" method="POST" class="space-y-6 max-w-6xl">
                
                <div class="glass-card p-4 md:p-6 border-t-4 border-amber-500">
                    <h3 class="text-lg font-bold text-white mb-4"><i class="fas fa-bullhorn mr-2 text-amber-400"></i> Marketing, Affiliates & Rewards</h3>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4 pb-4 border-b border-slate-700/50">
                        <div class="bg-slate-900/50 p-3 rounded border border-slate-700 flex flex-col justify-center items-center">
                            <label class="text-amber-400 text-xs font-bold mb-2 uppercase">Flash Sale</label>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" name="flash_sale_active" class="sr-only peer" {% if s.get('flash_sale_active') %}checked{% endif %}>
                                <div class="w-11 h-6 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-amber-500"></div>
                            </label>
                        </div>
                        <div><label class="block text-[10px] text-slate-400 font-bold mb-1 uppercase">Flash Discount (%)</label><input type="number" step="0.1" name="flash_sale_discount" value="{{ s.get('flash_sale_discount', 0.0) }}" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none focus:border-amber-500"></div>
                        <div class="bg-slate-900/50 p-3 rounded border border-slate-700 flex flex-col justify-center items-center">
                            <label class="text-emerald-400 text-xs font-bold mb-2 uppercase">Join Bonus</label>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" name="welcome_bonus_active" class="sr-only peer" {% if s.get('welcome_bonus_active') %}checked{% endif %}>
                                <div class="w-11 h-6 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500"></div>
                            </label>
                        </div>
                        <div><label class="block text-[10px] text-slate-400 font-bold mb-1 uppercase">Welcome Bonus ($)</label><input type="number" step="0.001" name="welcome_bonus" value="{{ s.get('welcome_bonus', 0.0) }}" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none focus:border-emerald-500"></div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                        <div><label class="block text-[10px] text-slate-400 font-bold mb-1 uppercase">Ref Invite Bonus ($)</label><input type="number" step="0.001" name="ref_bonus" value="{{ s.get('ref_bonus', 0.05) }}" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none focus:border-amber-500"></div>
                        <div><label class="block text-[10px] text-slate-400 font-bold mb-1 uppercase">Deposit Commission (%)</label><input type="number" step="0.1" name="dep_commission" value="{{ s.get('dep_commission', 5.0) }}" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none focus:border-amber-500"></div>
                        
                        <div><label class="block text-[10px] text-yellow-400 font-bold mb-1 uppercase">üèÜ Top 1 Reward ($)</label><input type="number" step="0.1" name="reward_top1" value="{{ s.get('reward_top1', 10.0) }}" class="w-full bg-slate-900 border border-yellow-500/50 rounded px-3 py-2 text-white outline-none focus:border-yellow-500"></div>
                        <div><label class="block text-[10px] text-slate-300 font-bold mb-1 uppercase">ü•à Top 2 Reward ($)</label><input type="number" step="0.1" name="reward_top2" value="{{ s.get('reward_top2', 5.0) }}" class="w-full bg-slate-900 border border-slate-500/50 rounded px-3 py-2 text-white outline-none focus:border-slate-400"></div>
                        <div><label class="block text-[10px] text-orange-400 font-bold mb-1 uppercase">ü•â Top 3 Reward ($)</label><input type="number" step="0.1" name="reward_top3" value="{{ s.get('reward_top3', 2.0) }}" class="w-full bg-slate-900 border border-orange-500/50 rounded px-3 py-2 text-white outline-none focus:border-orange-500"></div>
                    </div>
                </div>

                <div class="glass-card p-4 md:p-6 border-t-4 border-rose-500">
                    <h3 class="text-lg font-bold text-white mb-4"><i class="fas fa-magic mr-2 text-rose-400"></i> Cyber Box Auto Engine</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div>
                            <label class="block text-[10px] text-sky-400 font-bold mb-1 uppercase">Proof Channel ID (e.g. @NexusProofs)</label>
                            <input type="text" name="proof_channel" value="{{ s.get('proof_channel', '') }}" placeholder="Channel ID for proofs" class="w-full bg-slate-900 border border-sky-500/50 rounded px-4 py-2 text-white data-font outline-none focus:border-sky-500">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="block text-[10px] text-slate-400 font-bold mb-1 uppercase">Dep Posts/Hour</label><input type="number" name="fake_dep_freq" value="{{ s.get('fake_dep_freq', 2) }}" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none focus:border-rose-500"></div>
                            <div><label class="block text-[10px] text-slate-400 font-bold mb-1 uppercase">Ord Posts/Hour</label><input type="number" name="fake_ord_freq" value="{{ s.get('fake_ord_freq', 3) }}" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none focus:border-rose-500"></div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                        <div><label class="block text-[10px] text-slate-400 font-bold mb-1 uppercase">DEP MIN ($)</label><input type="number" step="0.01" name="fake_deposit_min" value="{{ s.get('fake_deposit_min', 0.01) }}" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none"></div>
                        <div><label class="block text-[10px] text-slate-400 font-bold mb-1 uppercase">DEP MAX ($)</label><input type="number" step="0.01" name="fake_deposit_max" value="{{ s.get('fake_deposit_max', 20.0) }}" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none"></div>
                        <div><label class="block text-[10px] text-slate-400 font-bold mb-1 uppercase">ORD MIN ($)</label><input type="number" step="0.01" name="fake_order_min" value="{{ s.get('fake_order_min', 0.01) }}" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none"></div>
                        <div><label class="block text-[10px] text-slate-400 font-bold mb-1 uppercase">ORD MAX ($)</label><input type="number" step="0.01" name="fake_order_max" value="{{ s.get('fake_order_max', 10.0) }}" class="w-full bg-slate-900 border border-slate-700 rounded px-3 py-2 text-white outline-none"></div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-slate-900/50 p-3 rounded border border-slate-700 flex justify-between items-center">
                            <label class="text-rose-400 text-sm font-bold uppercase">Auto Fake Engine</label>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" name="fake_proof_status" class="sr-only peer" {% if s.get('fake_proof_status') %}checked{% endif %}>
                                <div class="w-9 h-5 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-rose-500"></div>
                            </label>
                        </div>
                        <div class="bg-slate-900/50 p-3 rounded border border-slate-700 flex justify-between items-center">
                            <label class="text-indigo-400 text-sm font-bold uppercase">Night Mode (Sleep 2AM-8AM)</label>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" name="night_mode" class="sr-only peer" {% if s.get('night_mode') %}checked{% endif %}>
                                <div class="w-9 h-5 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-indigo-500"></div>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="glass-card p-4 md:p-6 border-t-4 border-indigo-500">
                    <h3 class="text-lg font-bold text-white mb-4"><i class="fas fa-sliders-h mr-2 text-indigo-400"></i> Core Panel Engine</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                        <div>
                            <label class="block text-[10px] text-slate-400 font-bold mb-1 uppercase">Global Profit Margin (%)</label>
                            <input type="number" step="0.1" name="profit_margin" value="{{ s.get('profit_margin', 20.0) }}" class="w-full bg-slate-900 border border-slate-700 rounded px-4 py-2 text-white data-font outline-none focus:border-indigo-500">
                        </div>
                        
                        <div>
                            <label class="block text-[10px] text-sky-400 font-bold mb-1 uppercase"><i class="fas fa-lock text-xs"></i> Force Sub Channels</label>
                            <input type="text" name="channels" value="{{ s.get('channels', []) | join(', ') }}" placeholder="@Channel1, @Channel2" class="w-full bg-slate-900 border border-sky-500/50 rounded px-4 py-2 text-white outline-none focus:border-sky-500">
                        </div>
                        
                        <div>
                            <label class="block text-[10px] text-amber-400 font-bold mb-1 uppercase">Admin Live Log Channel</label>
                            <input type="text" name="log_channel" value="{{ s.get('log_channel', '') }}" placeholder="To spy user actions" class="w-full bg-slate-900 border border-amber-500/50 rounded px-4 py-2 text-white outline-none focus:border-amber-500">
                        </div>
                        
                        <div class="bg-slate-900/50 p-3 rounded border border-slate-700 flex flex-col justify-center">
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-red-400 text-xs font-bold uppercase"><i class="fas fa-tools"></i> Maintenance Mode</label>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" name="maintenance" class="sr-only peer" {% if s.get('maintenance') %}checked{% endif %}>
                                    <div class="w-9 h-5 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-red-500"></div>
                                </label>
                            </div>
                            <input type="text" name="maintenance_msg" value="{{ s.get('maintenance_msg', 'Bot is upgrading.') }}" placeholder="Custom maintenance message..." class="w-full bg-slate-950 border border-slate-800 rounded px-2 py-1 text-xs text-slate-300 outline-none focus:border-red-500">
                        </div>
                    </div>
                </div>

                <div class="glass-card p-4 md:p-6 border-t-4 border-fuchsia-500">
                    <h3 class="text-lg font-bold text-white mb-2"><i class="fas fa-layer-group mr-2 text-fuchsia-400"></i> Tiered Profit Margins</h3>
                    <p class="text-[10px] text-slate-400 mb-4 uppercase tracking-wider">Set custom profit margins based on the base cost of the service. (Leave blank if not needed)</p>
                    <div class="space-y-3">
                        {% for i in range(3) %}
                        {% set t = s.get('profit_tiers', []) %}
                        {% set tier = t[i] if t|length > i else {} %}
                        <div class="flex flex-col sm:flex-row gap-3 bg-slate-900/50 p-3 rounded border border-slate-700/50 hover:border-fuchsia-500/50 transition-colors">
                            <div class="flex-1">
                                <label class="block text-[9px] text-slate-500 font-bold mb-1 uppercase">Min Cost ($)</label>
                                <input type="number" step="0.001" name="tier_min[]" value="{{ tier.get('min', '') }}" placeholder="0.0" class="w-full bg-slate-950 border border-slate-800 rounded px-3 py-1.5 text-xs text-white outline-none focus:border-fuchsia-500">
                            </div>
                            <div class="flex-1">
                                <label class="block text-[9px] text-slate-500 font-bold mb-1 uppercase">Max Cost ($)</label>
                                <input type="number" step="0.001" name="tier_max[]" value="{{ tier.get('max', '') }}" placeholder="5.0" class="w-full bg-slate-950 border border-slate-800 rounded px-3 py-1.5 text-xs text-white outline-none focus:border-fuchsia-500">
                            </div>
                            <div class="flex-1">
                                <label class="block text-[9px] text-fuchsia-400 font-bold mb-1 uppercase">Profit Margin (%)</label>
                                <input type="number" step="0.1" name="tier_margin[]" value="{{ tier.get('margin', '') }}" placeholder="30.0" class="w-full bg-slate-950 border border-fuchsia-500/30 rounded px-3 py-1.5 text-xs text-white outline-none focus:border-fuchsia-500 font-bold">
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <div class="glass-card p-4 md:p-6 border-t-4 border-emerald-500">
                    <h3 class="text-lg font-bold text-white mb-4"><i class="fas fa-wallet mr-2 text-emerald-400"></i> Manual Payment Gateways</h3>
                    <div id="payment-methods" class="space-y-3">
                        {% for p in s.get('payments', []) %}
                        <div class="payment-row flex flex-col gap-2 bg-slate-900/50 p-3 rounded border border-slate-700/50 relative hover:border-emerald-500/50 transition-colors">
                            <div class="flex flex-col sm:flex-row gap-2">
                                <input type="text" name="pay_name[]" value="{{ p.name }}" placeholder="Method Name (e.g. Bkash)" class="flex-1 bg-slate-950 border border-slate-800 rounded px-3 py-2 text-sm text-white outline-none focus:border-emerald-500" required>
                                <input type="number" step="0.01" name="pay_rate[]" value="{{ p.rate }}" placeholder="Rate per 1 USD" class="w-full sm:w-32 bg-slate-950 border border-slate-800 rounded px-3 py-2 text-sm text-white data-font outline-none focus:border-emerald-500" required>
                            </div>
                            <div class="flex gap-2 items-center">
                                <input type="text" name="pay_address[]" value="{{ p.address }}" placeholder="Account Number or Crypto Address" class="flex-1 bg-slate-950 border border-slate-800 rounded px-3 py-2 text-sm text-white outline-none focus:border-emerald-500" required>
                                <button type="button" onclick="this.closest('.payment-row').remove()" class="text-slate-500 hover:text-red-500 px-3 transition-colors bg-slate-950 py-2 rounded border border-slate-800"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    <button type="button" onclick="addPaymentRow()" class="mt-4 bg-emerald-500/10 hover:bg-emerald-500 hover:text-slate-900 text-emerald-400 font-bold px-5 py-2 rounded text-xs uppercase tracking-wider transition-colors border border-emerald-500/30">
                        <i class="fas fa-plus mr-1"></i> Add Manual Gateway
                    </button>
                </div>

                <div class="glass-card p-4 md:p-6 border-t-4 border-cyan-500">
                    <h3 class="text-lg font-bold text-white mb-4"><i class="fab fa-bitcoin mr-2 text-cyan-400"></i> Auto Crypto Payments API</h3>
                    
                    <div class="grid grid-cols-1 xl:grid-cols-2 gap-4">
                        <div class="bg-slate-900/50 p-4 rounded border border-slate-700/50 border-l-2 border-l-cyan-400">
                            <div class="flex justify-between items-center mb-3 border-b border-slate-700/50 pb-2">
                                <h4 class="text-sm font-bold text-cyan-400">Cryptomus V1</h4>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" name="cryptomus_active" class="sr-only peer" {% if s.get('cryptomus_active') %}checked{% endif %}>
                                    <div class="w-9 h-5 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-cyan-500"></div>
                                </label>
                            </div>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-[9px] text-slate-400 font-bold mb-1 uppercase">Merchant ID</label>
                                    <input type="text" name="cryptomus_merchant" value="{{ s.get('cryptomus_merchant', '') }}" placeholder="e.g. 8b03..." class="w-full bg-slate-950 border border-slate-800 rounded px-3 py-1.5 text-xs text-white outline-none focus:border-cyan-500">
                                </div>
                                <div>
                                    <label class="block text-[9px] text-slate-400 font-bold mb-1 uppercase">Payment API Key</label>
                                    <input type="password" name="cryptomus_api" value="{{ s.get('cryptomus_api', '') }}" placeholder="Secret API Key" class="w-full bg-slate-950 border border-slate-800 rounded px-3 py-1.5 text-xs text-white outline-none focus:border-cyan-500">
                                </div>
                            </div>
                        </div>

                        <div class="bg-slate-900/50 p-4 rounded border border-slate-700/50 border-l-2 border-l-yellow-400">
                            <div class="flex justify-between items-center mb-3 border-b border-slate-700/50 pb-2">
                                <h4 class="text-sm font-bold text-yellow-400">CoinPayments</h4>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" name="coinpayments_active" class="sr-only peer" {% if s.get('coinpayments_active') %}checked{% endif %}>
                                    <div class="w-9 h-5 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-yellow-500"></div>
                                </label>
                            </div>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-[9px] text-slate-400 font-bold mb-1 uppercase">Public Key</label>
                                    <input type="text" name="coinpayments_pub" value="{{ s.get('coinpayments_pub', '') }}" placeholder="Public Key" class="w-full bg-slate-950 border border-slate-800 rounded px-3 py-1.5 text-xs text-white outline-none focus:border-yellow-500">
                                </div>
                                <div>
                                    <label class="block text-[9px] text-slate-400 font-bold mb-1 uppercase">Private Key / IPN Secret</label>
                                    <input type="password" name="coinpayments_priv" value="{{ s.get('coinpayments_priv', '') }}" placeholder="Private Key" class="w-full bg-slate-950 border border-slate-800 rounded px-3 py-1.5 text-xs text-white outline-none focus:border-yellow-500">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end pt-4">
                    <button type="submit" class="bg-sky-500 hover:bg-sky-400 text-slate-900 font-bold px-8 py-3 rounded-lg w-full sm:w-auto shadow-[0_0_15px_rgba(56,189,248,0.4)] hover:shadow-[0_0_25px_rgba(56,189,248,0.6)] text-lg transition-all uppercase tracking-wider">
                        <i class="fas fa-save mr-2"></i> Save Master Settings
                    </button>
                </div>
            </form>

            <div class="glass-card p-4 md:p-6 border-t-4 border-yellow-500 mt-8">
                <h3 class="text-lg font-bold text-white mb-4"><i class="fas fa-star mr-2 text-yellow-400"></i> Best Choice Services (Admin Picks)</h3>
                <form action="/save_best_choice" method="POST" class="flex flex-col md:flex-row gap-4">
                    <input type="text" name="best_choice_sids" value="{{ s.get('best_choice_sids', []) | join(', ') }}" placeholder="Comma separated SIDs (e.g. 10, 25, 102)" required class="flex-1 bg-slate-900 border border-slate-700 rounded px-4 py-2 text-white outline-none focus:border-yellow-500 data-font">
                    <button type="submit" class="bg-yellow-500 hover:bg-yellow-400 text-slate-900 font-bold px-6 py-2 rounded transition-colors shadow-[0_0_10px_rgba(234,179,8,0.3)]">Save Best Choices</button>
                </form>
            </div>
            
        </div>
    </main>

    <script>
        // UI Scripts
        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobile-overlay');
            if (sidebar.classList.contains('-translate-x-full')) {
                sidebar.classList.remove('-translate-x-full'); 
                overlay.classList.remove('hidden'); 
                setTimeout(() => overlay.classList.remove('opacity-0'), 10);
            } else {
                sidebar.classList.add('-translate-x-full'); 
                overlay.classList.add('opacity-0'); 
                setTimeout(() => overlay.classList.add('hidden'), 300);
            }
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.remove('hidden'); 
            document.getElementById('btn-' + tabId).classList.add('active');
            if (window.innerWidth < 768) { 
                const sidebar = document.getElementById('sidebar'); 
                if (!sidebar.classList.contains('-translate-x-full')) toggleMobileMenu(); 
            }
        }

        function filterTable(tableId, inputId) {
            let input = document.getElementById(inputId).value.toLowerCase();
            let rows = document.getElementById(tableId).getElementsByTagName('tbody')[0].getElementsByTagName('tr');
            
            for (let i = 0; i < rows.length; i++) {
                let text = rows[i].innerText.toLowerCase();
                rows[i].style.display = text.includes(input) ? '' : 'none';
            }
        }

        // Modal Scripts
        function openUserModal(uid, bal, spent, refEarn, discount, tier, points) {
            document.getElementById('modal_uid').value = uid;
            document.getElementById('modal_uid_display').innerText = `(${uid})`;
            document.getElementById('modal_balance_val').value = parseFloat(bal).toFixed(3);
            document.getElementById('modal_spent').value = parseFloat(spent).toFixed(3);
            document.getElementById('modal_ref').value = parseFloat(refEarn).toFixed(3);
            document.getElementById('modal_discount').value = discount;
            document.getElementById('modal_tier').value = tier;
            document.getElementById('modal_points').value = points;
            
            const modal = document.getElementById('userEditModal');
            const box = document.getElementById('userEditBox');
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                box.classList.remove('scale-95');
                box.classList.add('scale-100');
            }, 10);
        }

        function closeUserModal() {
            const modal = document.getElementById('userEditModal');
            const box = document.getElementById('userEditBox');
            modal.classList.add('opacity-0');
            box.classList.remove('scale-100');
            box.classList.add('scale-95');
            setTimeout(() => modal.classList.add('hidden'), 300);
        }

        // Fake Data Injector Script
        async function generateRivals() {
            const btn = document.getElementById('btn_rivals');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-1"></i> Working...';
            btn.classList.add('opacity-50', 'pointer-events-none');
            
            const names = ["SMM King", "Alex Crypto", "David W.", "SEO Master", "Sarah J.", "Michael", "Emma", "Global SMM", "VIP Reseller", "Trust Boost"];
            
            for(let i=0; i<3; i++){
                let fd = new FormData();
                fd.append('fake_name', names[Math.floor(Math.random()*names.length)] + " " + Math.floor(Math.random()*99));
                fd.append('fake_spent', (Math.random() * (300 - 10) + 10).toFixed(2));
                fd.append('fake_ref', (Math.random() * (50 - 5) + 5).toFixed(2));
                await fetch('/add_fake_user', {method: 'POST', body: fd});
            }
            location.reload();
        }

        // Fake Live User Count Animation
        setInterval(() => {
            let count = Math.floor(Math.random() * (120 - 45 + 1)) + 45;
            document.getElementById('live_users_count').innerText = count;
        }, 12000); 

        // Dynamic Payment Row Adder
        function addPaymentRow() {
            const container = document.getElementById('payment-methods');
            const row = document.createElement('div');
            row.className = 'payment-row flex flex-col gap-2 bg-slate-900/50 p-3 rounded border border-emerald-500/50 relative mt-3 animate-[fadeIn_0.2s_ease-out]';
            row.innerHTML = `
                <div class="flex flex-col sm:flex-row gap-2">
                    <input type="text" name="pay_name[]" placeholder="Method Name (e.g. Binance Pay)" class="flex-1 bg-slate-950 border border-slate-800 rounded px-3 py-2 text-sm text-white outline-none focus:border-emerald-500" required>
                    <input type="number" step="0.01" name="pay_rate[]" placeholder="Rate (e.g. 1)" class="w-full sm:w-32 bg-slate-950 border border-slate-800 rounded px-3 py-2 text-sm text-white data-font outline-none focus:border-emerald-500" required>
                </div>
                <div class="flex gap-2 items-center">
                    <input type="text" name="pay_address[]" placeholder="Account Number or Crypto Address" class="flex-1 bg-slate-950 border border-slate-800 rounded px-3 py-2 text-sm text-white outline-none focus:border-emerald-500" required>
                    <button type="button" onclick="this.closest('.payment-row').remove()" class="text-slate-500 hover:text-red-500 px-3 transition-colors bg-slate-950 py-2 rounded border border-slate-800"><i class="fas fa-trash"></i></button>
                </div>
            `;
            container.appendChild(row);
        }
    </script>
</body>
</html>
